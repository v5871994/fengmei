/*! TenVideoPlayer_V2 - v2.0.0 - 2015-06-16 19:49:38
 * Copyright (c) 2015
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a,b){function c(b){{var c;b.t}return b.relatedBtn&&(g?(c=a.$.getUrlParam("from",b.relatedBtn.attr("href")),c=c.replace(/\D/g,"")):c=a.$.getUrlParam("confid",b.relatedBtn.attr("data-downloadurl"))),!c&&b.promotionId&&(c=b.promotionId),!c&&b.downloadBtn&&(c=b.downloadBtn.attr("data-promotionId")),c||666}function d(d,e){var f={cmd:3537,int5:d,str4:g?3:1,str8:b.getUrlParam("mmuin"),val:e.initStep||1},h=e.t;f.int6=c(e),a.app.report(f,h)}function e(a){this.userop=a;var c=b.extend({},f,a);return this.op=c,this.init(c),this}var f={pluginName:"AppRecommend",text1:"\u67e5\u770b\u516c\u4f17\u53f7\u66f4\u591a\u89c6\u9891",picCgi:a.common.get_request_url("rmd_mobile"),navCurrentClass:"tvp_current",downloader:!0,range:[1,2],downloaderCallback:"transferDownloadState",tpl:['<div data-role="relatebox" id="${relateid}" class="tvp_related_layer tvp_related_layer_nobanner tvp_none">','<div class="tvp_related">','<div data-role="relatemove" class="tvp_related_inner">',"<% for(var i=0;i<list.length;i++) {%>",'<ul class="tvp_related_list">',"<% for(var j=0;j<list[i].length;j++) {%>",'<li class="tvp_item">','<a data-alginfo="<%=list[i][j].alginfo%>" data-action="applink" data-vid="<%=list[i][j].id%>" ${iframe} data-role="relatelink" data-url="#" href="#" class="tvp_related_link">','<div class="tvp_figure"><img src="<%=list[i][j].pic3url%>" alt="" class="tvp_pic"></div>','<div class="tvp_title"><%=list[i][j].title%></div>',"</a>","</li>","<% }%>","</ul>","<% }%>","</div>",'<div class="tvp_related_nav">',"<% for(var i=0;i<navCount;i++) {%>",'<div data-role="relatetrigger" class="tvp_dot"></div>',"<% }%>","</div>",'<div class="tvp_related_gap"></div>',"</div>",'<div data-role="replay" class="tvp_replay"><div class="tvp_icon_replay"></div>\u91cd\u65b0\u64ad\u653e</div>',"</div>"].join(""),tpl2:['<div style="display:none;" data-role="relatebox" class="tvp_related" id="${relateid}">','   <div data-role="relatemove" class="tvp_related_inner">',"		<% for(var i=0;i<list.length;i++) {%>","			<% if(i==0) {%>",'			<ul class="${listclass}">',"			<% }%>","			<% if(i>0 && i%3==0) {%>","			</ul>",'			<ul class="${listclass}">',"			<% }%>",'			<li class="tvp_item">','				<a data-action="applink" ${iframe} data-role="relatelink" data-url="#" href="#" data-vid="<%=list[i].id%>" class="tvp_related_link"><img class="tvp_figure" src="<%=list[i].picurl%>" /><strong class="tvp_title"><%=list[i].title%></strong></a>',"			</li>","			<% if(i==list.length-1) {%>","			</ul>","			<% }%>","		<% }%>","   </div>","	<% if(list.length>3) {%>",'	<div class="tvp_related_nav">',"	<% for(var i=0;i<list.length;i++) {%>","		<% if(i%3==0) {%>",'			<i data-role="relatetrigger" class="dot"></i>',"		<% }%>","	<% }%>","   </div>","	<% }%>","</div>",'<div style="display:none;" data-role="replay" class="tvp_replay"><i class="tvp_icon_replay"></i>\u91cd\u65b0\u64ad\u653e</div>'].join(""),recommendTips:['<div class="related_banner" data-role="relatetips">','  <div class="related_banner_inner">\u5230\u817e\u8baf\u89c6\u9891\u5ba2\u6237\u7aef\uff0c\u770b\u66f4\u591a\u7cbe\u5f69\u63a8\u8350</div>',"</div>"].join(""),bannerTpl:['<div data-role="appbannerbox" class="tvp_app_download" style="display:none">','   <a data-action="applink" data-role="appbannerlink" class="tvp_download_app" href="${url}" ${iframe}>','		<i class="tvp_icon_logo"></i>','		<span class="tvp_download_app_wording"><span class="tvp_download_app_title" data-role="appbannertext1">${text1}</span><span data-role="appbannertext2" class="tvp_download_app_desc">${text2}</span></span>','		<span data-role="appbannerbtntext" class="tvp_app_btn_em">${btnText}</span>',"	</a>","</div>"].join(""),downLoadLayer:'<div class="tvp_download_layer" data-role="download-layer" style="display:none;">							<div class="tvp_promote_text" data-role="promote-text">\u6b63\u5728\u4e0b\u8f7d\u817e\u8baf\u89c6\u9891\uff0c\u9a6c\u4e0a\u5c31\u80fd\u89c2\u770b\u54df</div>							<div class="tvp_promote_download" data-status="downloading">								<div class="tvp_promote_progress" data-role="appbannerbtnprogress"></div>							</div>							<div class="tvp_dowanload_finish tvp_none" data-role="finish">								<span class="tvp_icon_finish"></span>								<span class="tvp_btn">\u4e0b\u8f7d\u5df2\u5b8c\u6210\uff0c\u70b9\u51fb\u5b89\u88c5</span>							</div>						</div>',installedTips:'<div class="tvp_install_success">									<div class="tvp_tips">\u5b89\u88c5\u5df2\u5b8c\u6210\uff0c<br>\u70b9\u51fb\u53ef\u76f4\u63a5\u64ad\u653e</div>									<span class="tvp_arrow"></span>								</div>'},g=!1,h=!1,i={};b.extend(e.prototype,{init:function(a){var c=a.t,d=this;this.op=b.extend(a,{$mod:c.$UILayer||c.$videomod,currentIndex:0,relateid:"tvp_related_"+c.playerid,eventType:b.os.hasTouch?"touchend":"click",currentTime:0,replayClicked:!1,tjReportParams:"",isWechatIframe:2==a.type?!0:!1,vidArray:[]}),this.fixParams(a),this.initFirstEvent(a).done(function(){d.getList(a).done(function(b){b&&(d.initRoles(b),d.fixVideoUrl(a),d.initEvent(a))})})},isShowByLanscape:function(a){var b=!1,c=a.width(),d=a.height(),e=530;return c>d&&c>e&&(b=!0),b},initRoles:function(a){this.fixUI();var c=this.op,d=this,e=c.$mod,g=f.tpl,h="tvp_related_list tvp_related_list_v2";g=b.formatTpl(g,{relateid:c.relateid,listclass:h,iframe:window!=top?'target="_parent"':""});var i,j,k=[],l=[];if(a&&a.length){j=a.slice(0),i=Math.round(j.length/3);for(var m=0,n=Math.round(j.length/6)+1;n>m;m++)l=j.splice(0,6),l&&l.length&&k.push(l);var o=b.tmpl(g),p=this.isShowByLanscape(e),q=o({list:k,navCount:i});p&&e.addClass("tvp_landscape"),e.append(q);var r=function(){var a=function(){var a=d.isShowByLanscape(e);a?e.addClass("tvp_landscape"):e.removeClass("tvp_landscape"),c.currentIndex=0,d.move()};setTimeout(function(){a()},500)},s=window!==top&&top.location.href?top:window;s.addEventListener&&s.addEventListener("orientationchange",r,!1),this.$relateBox=e.find("[data-role=relatebox]"),this.$replay=e.find("[data-role=replay]"),this.$links=e.find("[data-role=relatelink]"),this.$triggers=e.find("[data-role=relatetrigger]"),this.$mover=e.find("[data-role=relatemove]"),this.$lists=e.find(".tvp_related_list"),this.fixTrigger();var t=e.find("div.tvp_download_layer"),u=t.find(".tvp_dowanload_finish");c.t.$video.on("tvp:appdownload:downloading",function(){u.addClass("tvp_none"),t.find(".tvp_promote_download").attr("data-status","downloading"),t.show()}).on("tvp:appdownload:complete",function(){u.removeClass("tvp_none"),b.downloadClick_wechat?b.downloadClick_wechat.bindDownloader(u.find(".tvp_btn")):b.downloadClick_mqq&&b.downloadClick_mqq.bindDownloader(u.find(".tvp_btn")),c.t.$video.one("tvp:appdownload:afterInstall",function(){var a=t.parent();t.hide(),a.append(f.installedTips),a.find(".tvp_install_success").one("click",function(){a.find(".tvp_install_success").remove()}),setTimeout(function(){a.find(".tvp_install_success").remove()},3e3)}),t.show()}).on("tvp:appdownload:fail",function(){t.hide()}).on("tvp:appdownload:pause",function(){t.find(".tvp_promote_download").attr("data-status","pause")})}},insertTip:function(){return},removeTip:function(){var a=this.op,b=a.$mod,c=b.find('[data-role="relatetips"]');c&&c.remove&&c.remove()},fixUI:function(){var a=this.op,c=a.t,d=a.$mod,e=d.find(".tvp_video");if(!c.$UILayer){d.addClass("tvp_container");var f=e.find(".tvp_shadow");f.length||(f=b('<div class="tvp_shadow"></div>').appendTo(e),f.hide()),this.$shadow=f}},fixShow:function(a){var b=this,c=this.op,e=c.t,f=c.$mod,i=this.$shadow,j=this.$relateBox,k=this.$replay,l=c.t.$video[0];"function"==typeof c.t.hasDurationLimit&&c.t.hasDurationLimit()||(a?(e.hidePlayer(l),e.$UILayer?(e.hideControl(),setTimeout(function(){e.$UILayer.removeClass("tvp_onpause")},100)):(f.addClass("tvp_finished"),i.show()),c.currentIndex=0,b.move(),j.show(),setTimeout(function(){f.find(".tvp_overlay_play").addClass("tvp_none")},550),k.show(),h||(d(g?6:1,c),h=!0)):(b.hasReport=!1,c.replayClicked||(j.hide(),k.hide(),e.showPlayer(l),e.$UILayer||(f.removeClass("tvp_finished"),i.hide()))))},getList:function(c){var d=b.Deferred(),e=f.picCgi,g={otype:"json",size:c.size||12,id:c.vid};return e=a.common.get_request_url("like"),g=c.isWechatIframe?b.extend(g,{uin:0,playright:7,pidx:0,msgtype:175,tablist:9}):b.extend(g,{uin:0,playright:7,pidx:0,msgtype:174,tablist:9}),b.ajax({url:e,data:g,dataType:"jsonp",jsonCache:600}).done(function(a){var e=!1,f=!1;a&&a.tablist&&1===a.tablist.length&&a.tablist[0]&&a.tablist[0].media_info&&a.tablist[0].media_info.length&&(e=a.tablist[0].media_info,c.tjReportParams=a.tablist[0]),e?(b.each(e,function(a,b){return c.vidArray.push(b.id),!c.isWechatIframe||b.id&&b.pic3url&&b.title?void 0:(f=!0,!0)}),f||d.resolve(e)):d.resolve()}).fail(function(){d.resolve()}),d},getAppBanner:function(){var a=this.op.t,c=b.Deferred();if(b.createAppBanner)c.resolve();else{var d=a.config.libpath+a.config.pluginUrl.AppBanner;b.getScript(d,function(){c.resolve()})}return c},fixUrl:function(a,b){return b&&(a=a.replace("${vid}",b)),a+"&from="+this.op.appmsgid+"&extend="+this.op.biz},fixVideoUrl:function(){var c=this,e=this.op,f=this.$links,h=b.extend({},e);h.vid="",a.app.check(h).done(function(h){h&&h.url&&(f.each(function(a,d){var e=b(d).data("vid");d.href=c.fixUrl(h.url,e),b(d).attr("data-url",c.fixUrl(h.openUrl,e))}),g=h.hasApp,g?f.on("click",function(){var a=b(this);e.relatedBtn=a,d(7,e)}):a.app.bindTryOpenAppBanner&&a.app.bindTryOpenAppBanner({$btn:f})),c.fixVideoUrlEvent(e)})},fixControl:function(a){var b=this.op,c=b.t,d=5,e=c.control.$control,f=c.instance.isFullScreen&&c.config.isHtml5UseFakeFullScreen,g=this.$relateBox;if(1==a&&f){var h=g.css("z-index");e.css("z-index",h+1),c.showControl()}1!==a&&e.css("z-index",d),2==a&&g.is("not:hidden")&&c.hideControl()},fixVideoUrlEvent:function(c){var d=this,e=this.$links;c.downloader&&(this.$relateBox.attr("data-downloadurl",c.downloadUrl),b.downloadClick_wechat&&b.downloadClick_wechat.hasDownloader&&(b.downloadClick_wechat.bindDownloader(this.$relateBox,"click"),a.app.getAppMd5(c.promotionId||236).done(function(a){a&&a.md5&&d.$relateBox.attr("data-downloadmd5",a.md5)})),b.downloadClick_mqq&&b.downloadClick_mqq.hasDownloader&&b.downloadClick_mqq.bindDownloader(this.$relateBox,"click")),e.on("click",function(){var d=b(this),e=d.attr("data-vid"),f=d.attr("data-alginfo");a.bossReport.apprecommend_report({tab_id:c.tjReportParams.tab_id,oper:2,vid:e,page:c.currentIndex,rlist:f})})},swipeReport:function(b,c){this.op;a.report({cmd:3556,val:b,val2:c})},fixParams:function(){function a(a){var d=b.getUrlParam(a,c);return d&&(d=decodeURIComponent(d),d=b.filterXSS(d)),d}var c=window!=top?document.referrer:document.location.href,d=this.op;d.biz=a("__biz"),d.appmsgid=a("appmsgid")},move:function(b){var c,e=this.op,f=0,h=e.currentIndex,j=0,k=e.$mod.width(),l=e.$mod.height(),m=this.isShowByLanscape(e.$mod),n=k>=top.innerWidth&&l>=top.innerHeight,o=!m&&!n;c=o?Math.round(e.vidArray.length/3)-1:Math.round(e.vidArray.length/6)-1,"left"==b&&(f=h+1),"right"==b&&(f=h-1),b||(f=h),0>f||f>c||(this.swipeReport(b,f),j-=f*k,this.$mover.css({"-webkit-transform":"translateX("+j+"px)"}),e.currentIndex=f,this.fixTrigger(),function(){if(!i.hasOwnProperty(f)){i[f]=null,d(g?6:1,e);var b=e.tjReportParams.media_info.slice(0),c=o?3:6,h=c*f,j=b.splice(h,c),k=[];a.$(j).each(function(a,b){k.push(b.alginfo)}),a.bossReport.apprecommend_report({tab_id:e.tjReportParams.tab_id,oper:1,vid:e.vid,page:f,rlist:k.join("+")})}}())},fillBanner:function(a){var c=this,d=b.extend({},c.userop,{style:"none",isAutoReport:!1,reportParams:{int5:1},t:a.t,vid:a.vid,tpl:f.bannerTpl,modId:a.relateid});this.getAppBanner().done(function(){b.createAppBanner(d).done(function(a){c.AppBanner=a;var b=a.$btn,d=b.attr("href");b.attr("href",c.fixUrl(d))})})},fixTrigger:function(){if(this.$triggers.length){var a=this.op.currentIndex,b=this.op;this.$triggers.removeClass(b.navCurrentClass).eq(a).addClass(b.navCurrentClass)}},initFirstEvent:function(a){var c=a.t,d=c.$video,e=d[0],f=!1,g=b.Deferred();return d.on("timeupdate",function(){e.currentTime&&(a.currentTime=e.currentTime),!f&&parseInt(c.getDuration())-parseInt(a.currentTime)<7&&(f=!0,g.resolve())}),g},recommendSwipe:function(){var a,c,d=this,e=!1,f=0,g=0,h=0,i=0,j=this.$relateBox;j.off("touchstart").off("touchmove").off("touchend").on("touchstart",function(b){if(e=!0,b&&b.touches&&b.touches.length){var c=b.touches[0];return a=c.target,f=c.pageX,h=c.pageY,!1}}).on("touchend",function(j){if(!e)return!0;if(!(j&&j.changedTouches&&j.changedTouches.length))return!0;var k=j.changedTouches[0];g=k.pageX,i=k.pageY,e=!1;var l=g-f,m=i-h,n=Math.abs(l),o=Math.abs(m);return 25>n&&25>o?(setTimeout(function(){if(!c){var d=b(a);d&&d.trigger&&d.trigger("click"),c=null}},380),k=j=null,!1):n>o&&n>30&&70>o?(d.move(0>l?"left":"right"),!1):void 0}).off("click.swipe").on("click.swipe",function(){c=!0})},initEvent:function(c){var d=c.t,e=this,f=d.$video,g=f[0],h=this.$replay;h.on(c.eventType,function(){c.replayClicked=!0,setTimeout(function(){c.replayClicked=!1,g.play(),parseInt(d.getDuration())-parseInt(c.currentTime)<6&&g.load(),g.currentTime=c.currentTime=0,g.play()},500)}),f.on("pause paused",function(){if(!d.isTouching){var a=parseInt(d.getDuration()),f=this,h=parseInt(b.os.iphone?c.currentTime:g.currentTime);return a-h>5?void e.fixShow(0):void setTimeout(function(){f.paused&&!e.op.t.control.isTouching&&e.fixShow(1)},400)}}),f.on("ended",function(){e.fixShow(1)}),f.on("play playing",function(){e.fixShow(0)}),this.recommendSwipe(),this.op.t.$mod.off("tvp:recommend:orientationchange").on("tvp:recommend:orientationchange",function(){e.move();try{b(top).off("orientationchange.recommend")}catch(a){}});try{b(top).off("orientationchange.recommend").on("orientationchange.recommend",function(){setTimeout(function(){e.move()},400)})}catch(i){}if(this.op.t.$mod.on("tvp:recommend:showtip",function(){e.insertTip()}),this.op.t.$mod.on("tvp:recommend:hidetip",function(){e.removeTip()}),d.control){var j=d.control.$control,k=j.find(a.html5skin.elements.fullscreen);k.on(c.eventType,function(){e.move()})}}}),b.extend(b,{createAppRecommend:function(a){var c=b.Deferred(),d=new e(a);return a.t&&(a.t.AppRecommend=d),c.resolve(d),c}})}(tvp,tvp.$),function(a,b){b.extend(a.Player.fn,{buildAppRecommend:function(c){var d=this;this.flashobj||a.$.browser.IEMobile||this.$videomod&&(!a.app||a.app.isSupportApp)&&setTimeout(function(){d.instance&&d.instance.DurationLimitInstance&&d.instance.DurationLimitInstance.enable||(c=c||{},c.t=d,c.vid=d.curVideo.getVid(),b.createAppRecommend(c))},5e3)}})}(tvp,tvp.$);/*  |xGv00|f46e8e9ab4f727d413107aeb14ec7abb */