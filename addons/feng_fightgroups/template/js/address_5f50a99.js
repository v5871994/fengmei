function loadRegions(){common.warmUpCache("region_list",[{key:"region_typed_1",url:"regions?region_type=1"},{key:"region_typed_2",url:"regions?region_type=2"},{key:"region_typed_3",url:"regions?region_type=3"}])}function ajax_getaddress(e,i,n){function o(e){if(1==i){$("#provinceId_m").html("<option value='0'>-选择省-</option>");for(var o=0;o<e.regions.length;o++){var s="<option value="+e.regions[o].region_id+">"+e.regions[o].region_name+"</option>";$("#provinceId_m").append(s)}$("#provinceId_m").val(n)}if(2==i){$("#cityId_m").css("visibility","visible"),$("#cityId_m").html("<option value='0'>-选择市-</option>"),$("#areaId_m").html("<option value='0'>-选择区/县-</option>");for(var o=0;o<e.regions.length;o++){var s="<option value="+e.regions[o].region_id+">"+e.regions[o].region_name+"</option>";$("#cityId_m").append(s)}$("#cityId_m").val(n)}if(3==i){$("#areaId_m").css("visibility","visible"),$("#areaId_m").html("<option value='0'>-选择区/县-</option>");for(var o=0;o<e.regions.length;o++){var s="<option value="+e.regions[o].region_id+">"+e.regions[o].region_name+"</option>";$("#areaId_m").append(s)}$("#areaId_m").val(n)}}function s(e){return common.log(e),alert("服务器数据错误，请稍后再试"),!1}var a=localStorage.getItem("region_typed_"+i),d=null;if(a&&(d=JSON.parse(a).data.regions),!d){var r="regions?parent_id="+e;return void common.invokeApi("GET",r,t,null,o,s)}var t={result:"ok",regions:[]};for(var c in d)d[c].parent_id==e&&t.regions.push(d[c]);o(t)}loadRegions(),$(document).ready(function(){function e(e){var i=e.trim();return 0==i.length||null==i?!0:!1}function i(){return window.location.search}function n(){$("#updateTip1").css("display","none"),$("#updateTip2").css("display","none"),$("#updateTip3").css("display","none"),$("#updateTip4").css("display","none"),$("#updateTip5").css("display","none"),$("#updateTip6").css("display","none"),$("#ID_span").css("display","none")}function o(i,o,s,a,d,r){return n(),e(i)?($("#updateTip1").css("display","block"),!1):11!=o.length||isNaN(o)?($("#updateTip2").css("display","block"),!1):0==s||null==s||0==s.length?($("#updateTip3").css("display","block"),!1):0==a||null==a||0==a.length?($("#updateTip4").css("display","block"),!1):0==d||null==d||0==d.length?($("#updateTip5").css("display","block"),!1):e(r)?($("#updateTip6").css("display","block"),!1):!0}var s,a,d,r=!1,t=(common.getApi("addresses?_ph="),common._GET().address_id),c=common._GET().goods_id,l=common._GET().sku_event_id,p=common._GET().sku_id,_="GET",m=null;t?($("#deletes").show(),s="addresses/"+t+"?_ph=",a=function(e){!e.address,ajax_getaddress(1,1,e.address.province_id),ajax_getaddress(e.address.province_id,2,e.address.city_id),ajax_getaddress(e.address.city_id,3,e.address.district_id),$("#provinceId_m").val(e.address.province_id),$("#cityId_m").val(e.address.city_id),$("#areaId_m").val(e.address.district_id),$("#name").val(e.address.receive_name),$("#adinfo").val(e.address.address),$("#mobile").val(e.address.mobile),$("#ID_card").val(e.address.id_number)},d=function(e){common.log(e)}):(s="wechat/region?_ph=",a=function(e){null!=e&&null!=e.region?(ajax_getaddress(1,1,e.region.province_id),ajax_getaddress(e.region.province_id,2,e.region.city_id),ajax_getaddress(e.region.city_id,3,0)):ajax_getaddress(1,1,0)},d=function(e){common.log(e)}),common.invokeApi(_,s,m,null,a,d),$("#provinceId_m").on("change",function(){return console.log("onchange"),n(),ajax_getaddress($(this).val(),2,0),$("#cityId_m").css("visibility","visible"),!1}),$("#cityId_m").on("change",function(){return n(),ajax_getaddress($(this).val(),3,0),$("#areaId_m").css("visibility","visible"),!1}),$("#deletes").on("click",function(){return r?!1:(confirm("确定删除这个地址吗")&&(r=!0,s="addresses/"+t+"?_ph=",_="DELETE",a=function(){window.location.href="addresses.html"+i()},d=function(e){common.log(e)},common.invokeApi(_,s,m,null,a,d)),!1)}),$("#add").on("click",function(){if(r)return!1;$(this).css("opacity","0.7"),r=!0;var e=$("#name").val(),n=$("#mobile").val(),u=$("#provinceId_m").val(),v=$("#cityId_m").val(),g=$("#areaId_m").val(),y=$("#adinfo").val(),f=$("#ID_card").val(),h=o(e,n,u,v,g,y,f);return common.log(h),h?(t?(_="PUT",s="addresses/"+t+"?_ph=",m='{"receive_name": "'+e+'","mobile": "'+n+'","province": "'+u+'","city": "'+v+'","district": "'+g+'","address": "'+y+'","country": "'+y+'","status": "DEFAULT","address_name": "","address_id": '+t+"}",a=function(){r=!1,location.href=document.referrer},d=function(e){r=!1,common.log(e)}):(_="POST",s="addresses?_ph=",m={receive_name:e,mobile:n,province:u,city:v,district:g,address:y,address_name:"",country:"1",id_number:f,status:"DEFAULT"},a=function(){window.location.href=void 0!=c&&void 0!=l&&void 0!=p?"order_checkout.html"+i():"addresses.html"},d=function(e){r=!1,common.log(e)}),common.invokeApi(_,s,m,null,a,d),!1):($(this).css("opacity","1"),r=!1,!1)})});